{% extends 'form_background.html' %}
<!DOCTYPE html>
{% load static %}

<html> 
    <body>
    {% block content %}
    <div class="title_bar">
       <!-- <img src="d2d-logo.png">-->
       <p style="color: white">D2D</p>
    </div>
    {% include "_modal.html" %}
    <div class="link">
            <button><a href="../../companyProfiles" class = "labels"> &#x2190 Profiles</a></button>
            <div class = "details-block">
            <span id = "title" class = "title"> <strong>{{ company.name }} </strong></span>
            <button class="update-company" type="button" name="button" data-id="{% url 'update_company' company.pk %}">
                <span><i class='fas fa-pen icons'></i></span></button>
                    <i class='fas fa-trash icons'></i>
                <div class="indent">
                    <span class = "labels">Contact Person </span>
                    <span class = "details" id = "contact">{{ company.contactPerson }}</span>
                    <br>
                    <span class = "labels">Company Number </span>
                    <span class = "details" id = "number"> {{ company.contactNumber }}</span>
                </div>
                <div class = "grid-x grid-padding-x profile-custom">
                    <div class = "large-6 medium-6 small-12 cell">
                        <span class = "labels">Searchable Websites</span>
                            {% for site in company.searchSites %}
                                <p class="details bolded">{{site}}</p>
                            {% endfor %}
                    </div>
                    <div class = "small-12 medium-6 large-6 cell">
                            <span class = "labels">Book Formats </span>
                            {% for bookFormat in company.bookFormats %}
                                <p class="details bolded">{{bookFormat}}</p>
                            {% endfor %}
                    </div>
                </div>

    <div class = "grid-x grid-padding-x">
        <div class = "large-8 medium-8 small-6 cell user-title">
            <span class = "title">Users</span>
            
        </div>
        <div class = "small-6 medium-4 large-4 cell button_padding user-title">
            <button class="create-user btn button_css" type="button" name="button">ADD USER</button>
        </div>
    </div>
    
    {% if users %}
    <div class="users_list ">
        <table>
            <tr class="headers">
                <th>Name</th>
                <th>Email</th>
                <th>Actions</th>
            </tr>
            {% for user in users %}
            <tr class="details">    
                <td>{{user.name}}</td>
                <td>{{user.email}}</td>
                <td>
                    <button type="button" class="update-user btn btn-sm btn-primary" data-id="{% url 'update_user' company.pk user.pk %}">
                        <i class='fas fa-pen icons'></i><span>Edit</span>
                    </button>
                    <br>
                    <button type="button" class="delete-user btn btn-sm btn-primary" data-id="{% url 'delete_user' company.pk user.pk %}">
                        <i class='fas fa-trash icons'></i><span>Delete</span>
                    </button>
                </td>
            </tr>
        {% endfor %}
        </table>
    {% else %}
        <p class="no-books text-primary">No users added yet.</p>
    {% endif %}
    </div>
    </div>
    <div class="col"> 
        <div class="row">
            <div class="col-12 mb-3">
            
            </div>
        </div>
    </div>
{% endblock content %}

{% block extrascripts %}
  <script type="text/javascript">
    $(function () {

      // Update company button
      $(".update-company").each(function () {
        $(this).modalForm({formURL: $(this).data('id')});
      })

      // Create user button
      $(".create-user").modalForm({formURL: "{% url 'create_user' company.pk %}", modalID: "#create-modal"});

      // Delete user buttons
      $(".delete-user").each(function () {
        $(this).modalForm({formURL: $(this).data('id')});
      })

      // Update user buttons
      $(".update-user").each(function () {
        $(this).modalForm({formURL: $(this).data('id')});
      })

    });
  </script>
{% endblock extrascripts %}
